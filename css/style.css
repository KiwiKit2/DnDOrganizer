/* Root theme vars */
:root {
  --bg: #0d0f11;
  --bg-alt: #14171a;
  --bg-raised: #1d2125;
  --border: #2a2f35;
  --border-accent: #444b53;
  --text: #d6d9dd;
  --text-dim: #7d848c;
  --accent: #4f8dff;
  --accent-glow: 174 72% 56%;
  --danger: #ff5576;
  --radius-s: 4px;
  --radius-m: 8px;
  --radius-l: 14px;
  --shadow-1: 0 2px 4px -2px rgba(0,0,0,.5),0 4px 16px -4px rgba(0,0,0,.4);
  font-family: 'Inter', system-ui, sans-serif;
  color-scheme: dark;
}

.light {
  --bg: #f5f7fa;
  --bg-alt: #ffffff;
  --bg-raised: #ffffff;
  --border: #dfe3e7;
  --border-accent: #b9c2ca;
  --text: #222;
  --text-dim: #66707a;
  --accent: #155eef;
  --danger: #d43652;
  color-scheme: light;
}

html,body {height:100%;margin:0;padding:0;background:var(--bg);color:var(--text);} 
body {display:flex;}

.app-shell {display:flex;flex:1;min-height:100vh;width:100%;}
.sidebar {width:220px;background:linear-gradient(180deg,var(--bg-alt),var(--bg));border-right:1px solid var(--border);display:flex;flex-direction:column;padding:18px 14px;gap:20px;}
.brand {font-size:20px;font-weight:600;letter-spacing:.5px;}
.nav {display:flex;flex-direction:column;gap:6px;}
.nav-btn {all:unset;cursor:pointer;padding:10px 12px;border-radius:var(--radius-m);font-size:14px;font-weight:500;background:var(--bg-raised);border:1px solid var(--border);transition:.25s;background:linear-gradient(145deg,#171b1f,#15181b);}
.nav-btn:hover {border-color:var(--border-accent);}
.nav-btn.active {background:var(--accent);color:#fff;box-shadow:0 0 0 1px #000,0 0 0 2px var(--accent);}
.sidebar-footer {margin-top:auto;display:flex;align-items:center;gap:10px;}
.toggle {display:flex;align-items:center;gap:4px;font-size:12px;cursor:pointer;}
.toggle input {accent-color:var(--accent);}

.main {flex:1;display:flex;flex-direction:column;}
.topbar {display:flex;align-items:center;gap:14px;padding:12px 18px;border-bottom:1px solid var(--border);background:var(--bg-alt);backdrop-filter:blur(8px);position:sticky;top:0;z-index:20;}
.breadcrumbs {font-size:13px;color:var(--text-dim);}
#search {background:var(--bg-raised);border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:var(--radius-l);min-width:220px;font-size:14px;}
#search:focus {outline:2px solid var(--accent);}
#themeSwitch {background:var(--bg-raised);color:var(--text);border:1px solid var(--border);border-radius:50%;width:38px;height:38px;cursor:pointer;font-size:16px;display:grid;place-items:center;}
#themeSwitch:hover {border-color:var(--accent);}
.pulse {animation:pulse 1s ease-in-out 0s 4 alternate;}
@keyframes pulse {from {box-shadow:0 0 0 0 var(--accent);} to {box-shadow:0 0 0 6px rgba(79,141,255,0);} }

.view {display:none;padding:18px 22px;animation:fade .4s ease;}
.view.active {display:block;}
@keyframes fade {from {opacity:0;transform:translateY(6px);} to {opacity:1;transform:translateY(0);} }

.toolbar {display:flex;justify-content:space-between;align-items:center;gap:20px;margin-bottom:12px;flex-wrap:wrap;}
.table-wrap {overflow:auto;border:1px solid var(--border);border-radius:var(--radius-m);background:var(--bg-raised);box-shadow:var(--shadow-1);max-height:calc(100vh - 250px);}
#dataTable {border-collapse:collapse;width:100%;min-width:800px;font-size:13px;}
#dataTable th,#dataTable td {padding:8px 10px;border-bottom:1px solid var(--border);text-align:left;}
#dataTable thead th {position:sticky;top:0;background:var(--bg-alt);z-index:5;font-weight:600;font-size:12px;letter-spacing:.5px;text-transform:uppercase;cursor:pointer;}
#dataTable tbody tr {transition:.15s;background:linear-gradient(145deg,#14171a,#121416);}
#dataTable tbody tr:hover {background:#1b2024;}
#dataTable tbody tr.selected {outline:2px solid var(--accent);}

.mini-btn, .accent-btn {all:unset;cursor:pointer;background:var(--accent);color:#fff;padding:8px 14px;border-radius:var(--radius-m);font-size:12px;font-weight:600;letter-spacing:.5px;box-shadow:0 2px 4px -2px rgba(0,0,0,.6),0 4px 10px -2px rgba(0,0,0,.4);}
.mini-btn {background:var(--bg-raised);color:var(--text);border:1px solid var(--border);padding:6px 10px;font-weight:500;}
.mini-btn:hover {border-color:var(--border-accent);}
.mini-btn:active {transform:translateY(1px);}
.accent-btn:hover {filter:brightness(1.1);}

select {background:var(--bg-raised);color:var(--text);border:1px solid var(--border);padding:6px 10px;border-radius:var(--radius-m);font-size:13px;}
select:focus {outline:2px solid var(--accent);}

.kanban {display:flex;gap:18px;align-items:flex-start;overflow-x:auto;padding-bottom:20px;}
.kanban-column {background:var(--bg-raised);border:1px solid var(--border);border-radius:var(--radius-m);min-width:260px;display:flex;flex-direction:column;max-height:calc(100vh - 240px);}
.kanban-column header {padding:10px 14px;font-size:13px;font-weight:600;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;}
.kanban-column header span {opacity:.55;font-weight:500;}
.kanban-cards {display:flex;flex-direction:column;gap:10px;overflow:auto;padding:14px;}
.card {background:linear-gradient(145deg,#20252a,#1b1f23);border:1px solid var(--border);border-radius:var(--radius-m);padding:10px 12px;font-size:12px;display:flex;flex-direction:column;gap:6px;cursor:grab;box-shadow:0 2px 4px -2px rgba(0,0,0,.6),0 4px 16px -4px rgba(0,0,0,.4);} 
.card.dragging {opacity:.4;}
.card h4 {margin:0;font-size:12px;font-weight:600;}
.card .meta {display:flex;flex-wrap:wrap;gap:6px;font-size:11px;color:var(--text-dim);}
.badge {background:var(--accent);color:#fff;padding:2px 6px;border-radius:var(--radius-s);font-size:10px;font-weight:600;letter-spacing:.5px;}
.card img.thumb {width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:10px;border:1px solid var(--border);background:#111;}
.grid-board {display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:16px;padding:10px 4px;}
.grid-token {background:var(--bg-raised);border:1px solid var(--border);border-radius:16px;padding:10px;display:flex;flex-direction:column;gap:8px;position:relative;box-shadow:var(--shadow-1);} 
.grid-token img {width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:12px;border:1px solid var(--border);background:#090b0d;}
.grid-token h5 {margin:0;font-size:13px;font-weight:600;}
.tag-row {display:flex;flex-wrap:wrap;gap:6px;font-size:10px;color:var(--text-dim);} 

.footer {margin-top:auto;padding:10px 18px;font-size:12px;color:var(--text-dim);border-top:1px solid var(--border);background:var(--bg-alt);display:flex;gap:18px;align-items:center;}

.prose {max-width:760px;}
.prose h1 {margin-top:0;font-size:28px;}
.prose code {background:var(--bg-raised);padding:2px 6px;border-radius:var(--radius-s);}

.stats-summary {display:grid;gap:12px;margin-top:24px;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));}
.stat-box {background:var(--bg-raised);border:1px solid var(--border);padding:14px 16px;border-radius:var(--radius-m);display:flex;flex-direction:column;gap:4px;}
.stat-box h3 {margin:0;font-size:13px;font-weight:600;color:var(--text-dim);}
.stat-box .value {font-size:20px;font-weight:600;}

/* Modal */
/* Map prototype */
.map-toolbar {display:flex;gap:12px;align-items:center;margin-bottom:12px;flex-wrap:wrap;}
.map-stage {position:relative;overflow:auto;border:1px solid var(--border);border-radius:18px;background:#0b0e10;min-height:520px;box-shadow:var(--shadow-1);} 
#battleMap {background:repeating-conic-gradient(from 0deg,#111 0deg,#111 90deg,#101417 90deg,#101417 180deg);background-size:60px 60px;display:block;border-radius:14px;}
.token-layer,.fog-layer,.walls-layer {position:absolute;left:0;top:0;pointer-events:none;inset:0;} 
.token {position:absolute;transform:translate(-50%,-50%);width:60px;height:60px;border:2px solid var(--accent);border-radius:50%;background:#222 center/cover no-repeat;box-shadow:0 4px 12px -4px rgba(0,0,0,.6);} 
.token[data-type="enemy"] {border-color:#ff5576;}
.token[data-type="player"] {border-color:#4f8dff;}
.map-hint {font-size:12px;color:var(--text-dim);margin-top:10px;}

/* Compendium */
.comp-toolbar {display:flex;gap:18px;align-items:center;margin-bottom:16px;flex-wrap:wrap;}
.comp-detail {margin-top:24px;padding:22px 24px;border:1px solid var(--border);border-radius:20px;background:var(--bg-raised);box-shadow:var(--shadow-1);} 
.comp-detail.hidden {display:none;}
.modal {position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;padding:30px;z-index:200;backdrop-filter:blur(4px);} 
.modal.hidden {display:none;}
.modal-panel {width:100%;max-width:640px;background:var(--bg-alt);border:1px solid var(--border);border-radius:18px;padding:26px 30px 34px;display:flex;flex-direction:column;gap:18px;box-shadow:0 10px 32px -8px rgba(0,0,0,.7);} 
.modal-panel header {display:flex;align-items:center;justify-content:space-between;margin:-6px -6px 4px;}
.modal-panel h2 {margin:0;font-size:20px;letter-spacing:.5px;}
.close-btn {all:unset;cursor:pointer;font-size:26px;line-height:1;padding:4px 10px;border-radius:10px;background:var(--bg-raised);border:1px solid var(--border);} 
.close-btn:hover {border-color:var(--border-accent);} 
textarea#sheetUrlInput {min-height:120px;background:var(--bg-raised);color:var(--text);border:1px solid var(--border);border-radius:14px;padding:12px 14px;font-family:ui-monospace,monospace;font-size:13px;resize:vertical;}
textarea#sheetUrlInput:focus {outline:2px solid var(--accent);} 
.modal .actions {display:flex;gap:14px;flex-wrap:wrap;}

::-webkit-scrollbar {width:10px;height:10px;}
::-webkit-scrollbar-track {background:var(--bg);}
::-webkit-scrollbar-thumb {background:var(--border);border-radius:6px;}
::-webkit-scrollbar-thumb:hover {background:var(--border-accent);}
